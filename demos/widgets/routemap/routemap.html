<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Routemap Demo - Web UI Framework Demos</title>
	<link rel="stylesheet" href="../../../jqm/css/themes/default/jquery.mobile.css" />
	<link rel="stylesheet" href="../../../css/themes/default/web-ui-fw.css" />
	<link rel="stylesheet" href="../../../jqm/demos/_assets/css/jqm-demos.css">
	<script src="../../../jqm/js/jquery.js"></script>
	<script src="../../../jqm/js/"></script>
	<script src="../../../js/"></script>
	<script src="../../_assets/js/"></script>
</head>
<body>
	<div data-role="page" id="routemap" data-dom-cache="true">
		<div data-role="header" data-position="fixed">
			<h1>Routemap Demo - Web UI Framework Demos</h1>
			<a href="../../" data-icon="home" data-iconpos="notext" data-ajax="false">Home</a>
		</div> <!--/header -->
		<div data-role="content">
			<div class="content-primary">
				<h3>Routemap</h3>
				<div data-demo-html="true" data-demo-js="true">
					<div id="routemapTest"
						data-role="routemap"
						data-db="routemap_data.json"
						data-unit="60">
					</div>
					<ul data-role="listview" data-inset="true">
						<li><a id='shortestWay'>shortestWay : 21 > 7</a></li>
						<li><a id='minimumTransfers'>minimumTransfers : 21 > 7</a></li>
						<li><a id='clearWay'>Clear</a></li>
						<li><a id='getNameById' href='#routePopup' data-rel='popup' data-position-to='window'>getNameById : "5"</a></li>
						<li><a id='getIdsByName' href='#routePopup' data-rel='popup' data-position-to='window'>getIdsByName : "5(ex)"</a></li>
						<li><a id='highlight'>highlight : 3 > 45 </a></li>
						<li><a id='dishighlight'>dishighlight : 3 > 45 </a></li>
						<li><a id='setDB'>setDB_object</a></li>
						<li><a id='setDB2'>setDB_json</a></li>
						<li><a id='setUnit'>setUnit</a></li>
					</ul>
					<div id="routePopup" data-role="popup" style="width:300px">
						<div data-role="header">
							<h1>Result</h1>
						</div>
						<div data-role="content">
							<p class="ui-popup-text">message</p>
							<center>
								<div>
									<a data-role="button" data-rel="back" data-inline="true">OK</a>
								</div>
							</center>
						</div>
					</div>
				</div>
			</div>
		</div> <!--/content -->
	</div>
	<script>
		$( document ).on( "routemapcreate", function ( e ) {
			var widget = $( "#routemapTest" ),
				startId = widget.routemap( "getIdsByName", "21" )[0],
				endId = widget.routemap( "getIdsByName", "7(ex)" )[0],
				$popup = $( "#routePopup .ui-popup-text"),
				path,
				DB_DATA = {
					"name": "Example Route Map",

					"exchangeStyle": {
						"backgroundColor": "white",
						"borderColor": "gray",
						"width" : 12,
						"height" : 12
					},

					"lines": [{
						"id": "line1",
						"name": "Line 1",
						"style": {
							"line" : { "stroke": "blue" },
							"station": {
								"borderColor": "blue",
								"width" : 8,
								"height" : 8
							}
						},
						"branches": [
							[
								{ "id": "11", "coordinates": [ 2, 1 ], "label": "ST1", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "12", "coordinates": [ 2, 2 ], "label": "ST2", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "13", "coordinates": [ 2, 3 ], "label": "ST3", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "14", "coordinates": [ 3, 5 ], "label": "ST4", "labelPosition": "e", "labelAngle": 0 }
							], [
								{ "id": "15", "coordinates": [ 2, 3 ], "label": "ST3", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "16", "coordinates": [ 1, 4 ], "label": "ST6", "labelPosition": "e", "labelAngle": 0 }
							]
						]
					}, {
						"id": "line2",
						"name": "Line 2",
						"style": {
							"line" : { "stroke": "red" },
							"station": {
								"borderColor": "red",
								"width" : 8,
								"height" : 8
							}
						},
						"branches": [
							[
								{ "id": "21", "coordinates": [ 1, 2 ], "label": "ST7", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "22", "coordinates": [ 2, 2 ], "label": "ST2", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "23", "coordinates": [ 3, 2 ], "label": "ST9", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "24", "coordinates": [ 3, 3 ], "label": "ST10", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "25", "coordinates": [ 3, 4 ], "label": "ST11", "labelPosition": "ne", "labelAngle": 45 },
								{ "id": "26", "coordinates": [ 3, 5 ], "label": "ST4", "labelPosition": "ne", "labelAngle": 45 }
							]
						]
					}]
				};

			widget.on( "select", function( e, id ) {
				widget.routemap( "dishighlight" );

				if ( id ) {
					widget.routemap( "highlight", [id] );
				}
			});

			$( "#setDB" ).on( "vclick", function () {
				widget.routemap( "option", "db", DB_DATA );
			});
			$( "#setDB2" ).on( "vclick", function () {
				widget.routemap( "option", "db", "routemap_data.json" );
			});

			$( "#setUnit" ).on( "vclick", function () {
				widget.routemap( "option", "unit", 80 );
			});

			$( "#shortestWay" ).on( "vclick", function () {
				path = widget.routemap( "shortestRoute", startId, endId );
				widget.routemap( "dishighlight" ).routemap( "highlight", path );
			});

			$( "#minimumTransfers" ).on( "vclick", function () {
				path = widget.routemap( "minimumTransfers", startId, endId );
				widget.routemap( "dishighlight" ).routemap( "highlight", path );
			});

			$( "#clearWay" ).on( "vclick", function () {
				widget.routemap( "dishighlight" );
			});

			$( "#getIdsByName" ).on( "vclick", function () {
				$popup.text( ( widget.routemap( "getIdsByName", "5(ex)" ) ) );
			});

			$( "#getNameById" ).on( "vclick", function () {
				$popup.text( ( widget.routemap( "getNameById", "5" ) ) );
			});

			$( "#highlight" ).on( "vclick", function () {
				widget.routemap( "highlight", ["3", "4", "33", "44", "45" ] );
			});

			$( "#dishighlight" ).on( "vclick", function () {
				widget.routemap( "dishighlight", ["3", "4", "33", "44", "45" ] );
			});
		});
	</script>
</body>
</html>
